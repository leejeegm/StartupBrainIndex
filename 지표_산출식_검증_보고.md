# 지표 산출식 검증 및 오류 체크 보고

## 1. 적용된 지표 산출식 (Step 3·하단 패널)

- **설문 1~5점 → 0~100 정규화:** `S_norm = (점수 − 1) ÷ 4 × 100`
- **영역별 통합 점수 (박사 논문 수식):** `영역점수 = (S_norm × w_s) + (E × w_e)`  
  - S_norm: 설문 정규화(0~100), E: 뇌파 지표(0~100)
- **4대 영역 가중치:**
  - 창업공감·동기부여: w_s=0.7, w_e=0.3
  - 창업위기감수·극복: w_s=0.5, w_e=0.5
  - 창업두뇌활용·계발: w_s=0.6, w_e=0.4
  - 주체적·창업의식: w_s=0.8, w_e=0.2
- **통합 지수:** 영역별 통합점수의 평균 (0~100). 뇌파 미사용 시 설문 정규화값만 사용.
- **뇌파 단일 사용 시:** `combined = (survey_weight×S_norm + eeg_weight×eeg_score) ÷ (survey_weight + eeg_weight)` (기본 0.6/0.4)

---

## 2. 검증 결과 요약

| 항목 | 수식/로직 | 검증 방법 | 결과 |
|------|-----------|-----------|------|
| 1~5 → 0~100 | `(x-1)/4*100` | 단위 검사: 1→0, 5→100, 3→50 | 통과 |
| 설문만 결합 지수 | combined_index = survey_sbi_normalized | test_survey_only | 통과 |
| 설문+뇌파 결합 | 0.6×S_norm + 0.4×eeg_score | S_norm=50, eeg=100 → 70 | 통과 |
| 영역별 (0.7/0.3) | 50×0.7+80×0.3=59 | 수동 계산 | 통과 |

- `test_analysis_combined.py` 2건 모두 통과.
- `_normalize_1_5_to_100(1)==0`, `(5)==100`, `(3)==50` 확인.
- `run_combined_analysis(survey_only)` 시 `combined_index == survey_sbi_normalized` 확인.
- `run_combined_analysis(survey, eeg=100)` 시 가중치 0.6/0.4로 70 산출 확인.

---

## 3. 오류·예외 처리

- **설문 점수 범위:** 1~5 밖이면 정규화 0.0 반환 (`analysis_engine._normalize_1_5_to_100`).
- **뇌파 미제공:** engagement/focus 없으면 alpha+beta 기반 휴리스틱 또는 50.0 사용.
- **통합 지수:** `min(100, max(0, value))`로 0~100 클리핑.
- **가중치 합 0:** `total_w <= 0`이면 1.0으로 나누어 0 나눗셈 방지.

---

## 4. 결론

- 제시된 지표 산출식과 `analysis_engine` 구현이 일치함.
- 단위 검사 및 기존 유닛 테스트로 산출 값이 정확히 계산되는 것을 확인함.
- 오류·예외 처리(범위, null, 0 나눗셈) 적용되어 있어 추가 오류는 발견되지 않음.
