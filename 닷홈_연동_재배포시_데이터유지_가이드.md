# leejee5.dothome.co.kr 무료 계정 + 시범운영 (재배포해도 데이터 유지)

시범운영 기간에 **수시로 재배포**해도 **회원·설문·대화·게시판 등 데이터가 유지**되려면, **DB를 앱 서버와 분리**해 두어야 합니다.

- **앱**: GitHub → Render 등에서 배포 (재배포 시 코드만 갱신)
- **DB**: **항상 같은 곳**에 두기 → 닷홈 MySQL 또는 무료 클라우드 MySQL

아래는 **닷홈(leejee5.dothome.co.kr) 무료 계정과 함께** 쓰는 방법과, 닷홈 MySQL 원격 접속이 안 될 때의 **대안**까지 정리한 내용입니다.

---

## 1. 구조 요약

| 구성 요소 | 역할 | 재배포 시 |
|-----------|------|-----------|
| **앱 (Render 등)** | FastAPI 서버 (회원가입, 설문, PDF, AI상담) | 재배포 시 **코드만** 갱신 |
| **DB (닷홈 MySQL 또는 외부 MySQL)** | 회원·설문·대화·게시판 등 **모든 저장 데이터** | **그대로 유지** |

앱은 환경변수로 `DB_HOST`, `DB_USER`, `DB_PASSWORD`, `DB_NAME`만 바꿔서 **어디에 있는 MySQL이든** 연결할 수 있습니다.

---

## 2. 방법 A: 닷홈 MySQL을 Render 앱에서 사용 (원격 접속 가능할 때)

닷홈에서 **MySQL 원격 접속**이 허용되어 있으면, Render 앱이 **닷홈 MySQL**에 직접 연결해 데이터를 쌓을 수 있습니다.

### 2-1. 닷홈에서 DB 정보 확인

1. **마이닷홈** 로그인 → **호스팅 관리** → **웹호스팅 목록** → **상세보기**
2. **DB 정보**에서 확인:
   - **DB 명(데이터베이스 이름)**
   - **DB 아이디**
   - **DB 암호**
   - **DB 호스트** (또는 접속 주소)  
     - `localhost`만 있으면 → **같은 서버(닷홈)에서만** 접속 가능. Render에서는 사용 불가.  
     - **원격 접속용 호스트**가 따로 안내되어 있으면 그 주소를 사용 (예: `mysql.dothome.co.kr` 또는 안내된 IP/도메인).

3. **원격 접속 허용**  
   - 상세보기나 DB 설정에 "원격 접속 허용", "외부 접속" 같은 메뉴가 있으면 **활성화**.  
   - 무료 호스팅에서 원격 MySQL을 막아 둔 경우가 많으므로, 없으면 **방법 B(외부 MySQL)** 로 진행합니다.

### 2-2. 닷홈 DB에 테이블 생성

앱이 사용하는 테이블을 **한 번만** 만들어 두어야 합니다.

1. 닷홈 **phpMyAdmin** 접속  
   - 매뉴얼: [phpMyAdmin 접속 방법](https://manual.dothome.co.kr/manual/info/86)  
   - 또는 호스팅 상세보기에서 "phpMyAdmin" 링크로 접속
2. 왼쪽에서 **해당 DB(예: leejee5)** 선택
3. **SQL** 탭에서 프로젝트의 **`create_tables_mysql.sql`** 내용 전체를 붙여넣고 **실행**
4. (이미 예전에 만든 DB라 컬럼이 부족하면) **`migrate_users_profile.sql`** 도 한 번만 실행

이후에는 앱이 자동으로 이 테이블들을 사용합니다.

### 2-3. Render 환경변수 (닷홈 MySQL 사용 시)

Render **Dashboard** → 해당 Web Service → **Environment**에서 다음을 넣습니다.

| Key | Value |
|-----|--------|
| `DB_ENGINE` | `mysql` |
| `DB_HOST` | 닷홈에서 안내한 **MySQL 호스트** (원격용. `localhost` 아님) |
| `DB_USER` | 닷홈 DB 아이디 |
| `DB_PASSWORD` | 닷홈 DB 암호 |
| `DB_NAME` | 닷홈 DB 명 |
| `SESSION_SECRET` | 랜덤 문자열 (세션 암호화용) |
| `PORT` | (비워 둠. Render가 자동 지정) |

저장 후 **재배포**하면, 앱은 계속 **닷홈 MySQL**만 바라보므로 **재배포를 반복해도 데이터는 닷홈에 그대로 쌓입니다.**

---

## 3. 방법 B: 닷홈 MySQL 원격 불가일 때 (무료 외부 MySQL + Render)

닷홈이 **localhost 전용**이거나 원격 접속을 안 해 주면, **무료로 쓸 수 있는 외부 MySQL**을 하나 쓰고, Render는 그쪽만 바라보게 하면 됩니다.  
닷홈(leejee5.dothome.co.kr)은 **홈페이지/소개 페이지**로만 쓰고, "SBI 체험하기" 버튼을 Render 앱 URL로 연결하는 식으로 함께 사용할 수 있습니다.

### 3-1. 무료 MySQL 호스팅 예시 (택 1)

- **PlanetScale** (https://planetscale.com)  
  - MySQL 호환, 무료 플랜 있음.  
  - 가입 → DB 생성 → **Connect**에서 호스트/유저/비밀번호 확인.  
  - 단, PlanetScale는 일부 MySQL 문법이 다를 수 있어, `create_tables_mysql.sql` 실행 시 오류 나면 해당 구문만 수정해 주면 됩니다.

- **Railway** (https://railway.app)  
  - 프로젝트에 **MySQL** 추가 시 연결 URL/호스트/유저/비밀번호/DB명 제공.  
  - 무료 크레딧 한도 내에서 사용.

- **그 외**  
  - "free MySQL hosting" 검색 시 나오는 서비스 중 **외부 접속 가능·무료**인 것을 골라, 호스트/유저/비밀번호/DB명을 받아 쓰면 됩니다.

### 3-2. 외부 MySQL에 테이블 생성

- 해당 서비스의 **웹 콘솔(phpMyAdmin 등)** 이 있으면:  
  선택한 DB에 `create_tables_mysql.sql` 내용 붙여넣어 실행.
- 또는 **로컬 PC**에서 MySQL 클라이언트로 접속해 동일 SQL 실행.

### 3-3. Render 환경변수 (외부 MySQL 사용 시)

방법 A와 동일하게, **다만 호스트/유저/비밀번호/DB명만** 선택한 외부 MySQL 정보로 넣습니다.

| Key | Value |
|-----|--------|
| `DB_ENGINE` | `mysql` |
| `DB_HOST` | 외부 MySQL 호스트 (예: xxx.planetscale.net 또는 Railway에서 준 호스트) |
| `DB_USER` | 해당 DB 유저 |
| `DB_PASSWORD` | 해당 DB 비밀번호 |
| `DB_NAME` | 해당 DB 이름 |
| `SESSION_SECRET` | 랜덤 문자열 |
| `PORT` | (비워 둠) |

이렇게 하면 **Render는 계속 재배포해도**, DB는 외부 MySQL 한 곳만 보기 때문에 **데이터 축적은 유지**됩니다.

---

## 4. 닷홈(leejee5.dothome.co.kr)과 “함께” 쓰는 방법

- **앱·DB**:  
  - 앱 = Render, DB = 닷홈 MySQL(원격 가능 시) **또는** 외부 무료 MySQL(원격 불가 시).  
  → 위 2단계 또는 3단계만 따르면 됨.

- **닷홈 사이트 활용**:  
  - leejee5.dothome.co.kr에는 **홈페이지/소개 페이지**를 두고,  
  - "SBI 창업가 뇌 지수 측정 체험하기" 같은 버튼/링크를 **Render 앱 URL**로 연결합니다.  
  - 예: `https://sbi-mvp.onrender.com`  
  → 사용자는 닷홈에서 들어와서 링크 한 번 누르면 Render 앱으로 이동, 회원가입·설문·데이터는 모두 위에서 설정한 MySQL에만 쌓입니다.

정리하면:

- **데이터 유지** = 앱(Render)과 DB(닷홈 MySQL 또는 외부 MySQL) 분리 + 환경변수로 DB만 가리키기.  
- **닷홈 무료 계정과 함께** = 닷홈은 홈페이지/랜딩용, 실제 서비스·DB는 Render + MySQL(닷홈 원격 또는 외부 무료).

---

## 5. 체크리스트 (재배포해도 데이터 유지)

- [ ] DB가 **앱 서버(Render)와 분리**되어 있음 (닷홈 MySQL 원격 또는 외부 MySQL)
- [ ] 해당 DB에 **`create_tables_mysql.sql`** 실행 완료 (필요 시 `migrate_users_profile.sql`도)
- [ ] Render **Environment**에 `DB_ENGINE=mysql`, `DB_HOST`, `DB_USER`, `DB_PASSWORD`, `DB_NAME` 설정
- [ ] 배포 후 회원가입·설문 저장 한 번 해 본 뒤, Render에서 **재배포** → 다시 로그인해 데이터 그대로인지 확인

이 구성을 유지하면 시범운영 기간에 **수시로 재배포해도 이전 데이터가 유지**됩니다.
